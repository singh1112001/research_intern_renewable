
%% CONDITION 01 : Substitute vm,im.
clc; 
syms rs rsh b 

r=1+(rs/rsh);
vm = 0.6755/0.5900 ;
im = 0.4590/0.7640 ;

Vih = -0.2057/0.5900 ;
Ivh = -0.2100/0.7640 ;

eqn1= 1+((Vih-vm)/(r*rsh))+((Ivh-1)-(Vih-1)/(r*rsh))*((exp(b*(Vih+rs))-exp(b*(vm+im*rs)))/(exp(b*(Vih+rs))-exp(b*(1+Ivh*rs))))-im;

% pretty(eqn1);

%% CONDITION 02 : di/dv = -im/vm.

syms rs rsh b v i

% i = 1+((Vih-v)/(r*rsh))+((Ivh-1)-(Vih-1)/(r*rsh))*((exp(b*(Vih+rs))-exp(b*(v+i*rs)))/(exp(b*(Vih+rs))-exp(b*(1+Ivh*rs))));

eqn2_1=(-1/(r*rsh))*(exp(b*(Vih+rs))-exp(b*(1+Ivh*rs))+b*exp(b*(v+i*rs))*((Ivh-1)*r*rsh-(Vih-1))) / (exp(b*(Vih+rs))-exp(b*(1+Ivh*rs))+b*rs*exp(b*(v+i*rs)));  
eqn2_11=subs(eqn2_1,{v,i},[vm,im]);
eqn2= eqn2_11+(im/vm);

% pretty(eqn2);

%% CONDITION 03 : RMSE 

V=[0.0057 0.0646 0.1185 0.1678 0.2132 0.2545 0.2924 0.3269 0.3585 0.3873 0.4137 0.4373 0.4590 0.4784 0.4960 0.5119 0.5265 0.5398 0.5521 0.5633]/0.5900;
I=[0.7605 0.7600 0.7590 0.7570 0.7570 0.7555 0.7540 0.7505 0.7465 0.7385 0.7280 0.7065 0.6755 0.6320 0.5730 0.4990 0.4130 0.3165 0.2120 0.1035]/0.7640;

syms rs rsh b 
s1=0;

eqn11= 1+((Vih-V)/(r*rsh))+((Ivh-1)-(Vih-1)/(r*rsh))*((exp(b*(Vih+rs))-exp(b*(V+I*rs)))/(exp(b*(Vih+rs))-exp(b*(1+Ivh*rs))));
a1=sum(I-eqn11);
a2=a1^2;
s1=s1+a2;
mean=s1/length(V);
eqn3=sqrt(mean)-0.0001;

% pretty(eqn3);
% %%

% syms rs rsh b
% b=[eqn1,eqn2,eqn3];
% s=solve(b,[rs,rsh,b])



%% CONDITION CHECK
 

k1=1000;
k2=500;
k3=10;

m=rs+eqn1/k1;
n=rsh-eqn2/k2;
p=b+eqn3/k3;

m1=diff(m,rsh);
m2=diff(m,rs);
m3=diff(m,b);

n1=diff(n,rs);
n2=diff(n,rsh);
n3=diff(n,b);

p1=diff(p,rs);
p2=diff(p,rsh);
p3=diff(p,b);


%%

rs=-0.4609;
rsh=-500;
b=15;

m0=2203/(7375000*rsh^2*(rs/rsh + 1)) - (2203*rs)/(7375000*rsh^3*(rs/rsh + 1)^2) - ((exp(b*((459*rs)/764 + 1351/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh^2*(rs/rsh + 1)) - (7957*rs)/(5900*rsh^3*(rs/rsh + 1)^2)))/(5000*(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))));
n0=1/(5000*rsh^2*(rs/rsh + 1)^2) + (459*b^2*exp(b*((459*rs)/764 + 1351/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(3820000*(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))) + (b*exp(b*((459*rs)/764 + 1351/1180))*((105*b*exp(-b*((105*rs)/382 - 1)))/382 + b*exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(5000*(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2) - (7957*b*exp(b*((459*rs)/764 + 1351/1180)))/(29500000*rsh^2*(rs/rsh + 1)^2*(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))));
p0=1 - ((((exp(b*((3*rs)/4 + 248/295)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - 32683/(1475*rsh*(rs/rsh + 1)) + ((exp(b*((759*rs)/764 + 237/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((377*rs)/382 + 731/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((158*rs)/191 + 1196/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((5*rs)/382 - 1434/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((413*rs)/764 + 1053/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 533/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((190*rs)/191 + 323/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1351*rs)/1528 + 459/590)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 - 147/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1511*rs)/1528 + 509/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1493*rs)/1528 + 717/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 839/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((633*rs)/1528 + 2699/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((381*rs)/382 - 1291/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 + 57/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((182*rs)/191 + 4137/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((53*rs)/191 + 5521/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1501*rs)/1528 + 3269/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((499*rs)/764 + 5119/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((123*rs)/764 - 5833/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1477*rs)/1528 + 3873/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1413*rs)/1528 + 4373/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((207*rs)/1528 + 5633/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + 4549/764)*(((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((3*rs)/4 + 248/295))*((3*rs)/4 + 248/295))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((759*rs)/764 + 237/1180))*((759*rs)/764 + 237/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((377*rs)/382 + 731/1475))*((377*rs)/382 + 731/1475))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((158*rs)/191 + 1196/1475))*((158*rs)/191 + 1196/1475))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((5*rs)/382 - 1434/1475))*((5*rs)/382 - 1434/1475))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((413*rs)/764 + 1053/1180))*((413*rs)/764 + 1053/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((757*rs)/764 + 533/1475))*((757*rs)/764 + 533/1475))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((190*rs)/191 + 323/2950))*((190*rs)/191 + 323/2950))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1351*rs)/1528 + 459/590))*((1351*rs)/1528 + 459/590))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1521*rs)/1528 - 147/1475))*((1521*rs)/1528 - 147/1475))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1511*rs)/1528 + 509/1180))*((1511*rs)/1528 + 509/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1493*rs)/1528 + 717/1180))*((1493*rs)/1528 + 717/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((757*rs)/764 + 839/2950))*((757*rs)/764 + 839/2950))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((633*rs)/1528 + 2699/2950))*((633*rs)/1528 + 2699/2950))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((381*rs)/382 - 1291/5900))*((381*rs)/382 - 1291/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1521*rs)/1528 + 57/5900))*((1521*rs)/1528 + 57/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((182*rs)/191 + 4137/5900))*((182*rs)/191 + 4137/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((53*rs)/191 + 5521/5900))*((53*rs)/191 + 5521/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1501*rs)/1528 + 3269/5900))*((1501*rs)/1528 + 3269/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((499*rs)/764 + 5119/5900))*((499*rs)/764 + 5119/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((123*rs)/764 - 5833/5900))*((123*rs)/764 - 5833/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1477*rs)/1528 + 3873/5900))*((1477*rs)/1528 + 3873/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((1413*rs)/1528 + 4373/5900))*((1413*rs)/1528 + 4373/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*(rs - 2057/5900))*(rs - 2057/5900) - exp(b*((207*rs)/1528 + 5633/5900))*((207*rs)/1528 + 5633/5900))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - ((exp(b*((3*rs)/4 + 248/295)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((759*rs)/764 + 237/1180)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((377*rs)/382 + 731/1475)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((158*rs)/191 + 1196/1475)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(-b*((5*rs)/382 - 1434/1475)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((413*rs)/764 + 1053/1180)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((757*rs)/764 + 533/1475)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((190*rs)/191 + 323/2950)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1351*rs)/1528 + 459/590)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1521*rs)/1528 - 147/1475)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1511*rs)/1528 + 509/1180)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1493*rs)/1528 + 717/1180)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((757*rs)/764 + 839/2950)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((633*rs)/1528 + 2699/2950)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((381*rs)/382 - 1291/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1521*rs)/1528 + 57/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((182*rs)/191 + 4137/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((53*rs)/191 + 5521/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1501*rs)/1528 + 3269/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((499*rs)/764 + 5119/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(-b*((123*rs)/764 - 5833/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1477*rs)/1528 + 3873/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((1413*rs)/1528 + 4373/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2 - ((exp(b*((207*rs)/1528 + 5633/5900)) - exp(b*(rs - 2057/5900)))*(exp(b*(rs - 2057/5900))*(rs - 2057/5900) + exp(-b*((105*rs)/382 - 1))*((105*rs)/382 - 1))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900)))^2))/(130000*((((exp(b*((3*rs)/4 + 248/295)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - 32683/(1475*rsh*(rs/rsh + 1)) + ((exp(b*((759*rs)/764 + 237/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((377*rs)/382 + 731/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((158*rs)/191 + 1196/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((5*rs)/382 - 1434/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((413*rs)/764 + 1053/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 533/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((190*rs)/191 + 323/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1351*rs)/1528 + 459/590)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 - 147/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1511*rs)/1528 + 509/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1493*rs)/1528 + 717/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 839/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((633*rs)/1528 + 2699/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((381*rs)/382 - 1291/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 + 57/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((182*rs)/191 + 4137/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((53*rs)/191 + 5521/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1501*rs)/1528 + 3269/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((499*rs)/764 + 5119/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((123*rs)/764 - 5833/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1477*rs)/1528 + 3873/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1413*rs)/1528 + 4373/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((207*rs)/1528 + 5633/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + 4549/764)^2/26)^(1/2));

cond_1 = abs(m1)+abs(m2)+abs(m3);
cond_2 = abs(n1)+abs(n2)+abs(n3);
cond_3 = abs(p1)+abs(p2)+abs(p3);



%%

x = fsolve(@myfn,[0.1337,152.5410,13.2831]);

function F = myfn(x)

rs=x(1);
rsh=x(2);
b=x(3);
% F1=a;
% F2=b;
% F3=c;
F1=((exp(b*((459*rs)/764 + 1351/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - 2203/(1475*rsh*(rs/rsh + 1)) + 305/764;
F2=(b*exp(b*((459*rs)/764 + 1351/1180))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - 1/(rsh*(rs/rsh + 1)) + 4726457481904829/9007199254740992;
F3=((((exp(b*((3*rs)/4 + 248/295)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) - 32683/(1475*rsh*(rs/rsh + 1)) + ((exp(b*((759*rs)/764 + 237/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((377*rs)/382 + 731/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((158*rs)/191 + 1196/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((5*rs)/382 - 1434/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((413*rs)/764 + 1053/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 533/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((190*rs)/191 + 323/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1351*rs)/1528 + 459/590)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 - 147/1475)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1511*rs)/1528 + 509/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1493*rs)/1528 + 717/1180)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((757*rs)/764 + 839/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((633*rs)/1528 + 2699/2950)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((381*rs)/382 - 1291/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1521*rs)/1528 + 57/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((182*rs)/191 + 4137/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((53*rs)/191 + 5521/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1501*rs)/1528 + 3269/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((499*rs)/764 + 5119/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(-b*((123*rs)/764 - 5833/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1477*rs)/1528 + 3873/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((1413*rs)/1528 + 4373/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + ((exp(b*((207*rs)/1528 + 5633/5900)) - exp(b*(rs - 2057/5900)))*(7957/(5900*rsh*(rs/rsh + 1)) - 487/382))/(exp(-b*((105*rs)/382 - 1)) - exp(b*(rs - 2057/5900))) + 4549/764)^2/26)^(1/2) - 1/10000;

F=[F1;F2;F3];
end 


%% 

% r1=diff(eqn1,rs);
% r2=diff(eqn1,rsh);
% r3=diff(eqn1,b);
% r0=abs(r1)+abs(r2)+abs(r3);
% % pretty(r0)
% 
% t1=diff(eqn2,rs);
% t2=diff(eqn2,rsh);
% t3=diff(eqn2,b);
% t=t1+t2+t3;
% % pretty(t);
% 
% s1=diff(eqn3,rs);
% s2=diff(eqn3,rsh);
% s3=diff(eqn3,b);
% s=s1+s2+s3;
% % pretty(s);
% 
% cond_1=subs(r0,{rs,rsh,b},[10.0227,0.26924,10]);
% 
% cond_20=subs(t1 ,{rs,rsh,b},[10.0227,0.26924,10])
% cond_21=subs(t2 ,{rs,rsh,b},[10.0227,0.26924,10])
% cond_22=subs(t3 ,{rs,rsh,b},[10.0227,0.26924,10])
% cond_2=cond_20+cond_21+cond_22
% 
% % cond_3=subs(s,{rs,rsh,b},[10.0227,0.26924,10]);
% % pretty(cond_3);
% % simplify(cond_1);
% 
% simplify(cond_2)
% % simplify(cond_3);

%% 

